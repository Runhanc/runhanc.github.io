<?xml version="1.0" encoding="utf-8"?>
<search>
  
  
  
  <entry>
    <title>旋转矩阵，四元数和欧拉角</title>
    <link href="/2025/05/08/hello-world/"/>
    <url>/2025/05/08/hello-world/</url>
    
    <content type="html"><![CDATA[<p>旋转矩阵，四元数和欧拉角</p><h2 id="Quick-Start"><a href="#Quick-Start" class="headerlink" title="Quick Start"></a>Quick Start</h2><h3 id="Create-a-new-post"><a href="#Create-a-new-post" class="headerlink" title="Create a new post"></a>Create a new post</h3><h1 id="旋转矩阵（Rotation-Matrix）"><a href="#旋转矩阵（Rotation-Matrix）" class="headerlink" title="旋转矩阵（Rotation Matrix）"></a>旋转矩阵（Rotation Matrix）</h1><h2 id="定义"><a href="#定义" class="headerlink" title="定义"></a>定义</h2><p>是一个用于描述坐标系绕某个轴旋转的正交矩阵，通常为3x3实矩阵，满足：</p><ul><li><p>正交性：$$R^TR&#x3D;I<br>$$</p></li><li><p>行列式为1：$$det(R)&#x3D;1$$</p></li></ul><h2 id="作用"><a href="#作用" class="headerlink" title="作用"></a>作用</h2><p>用于将三维空间中的向量$$\vec{v}<br>$$进行旋转：</p><p>$$\vec{v}_{rotated}&#x3D;R\vec{v}$$</p><h2 id="示例"><a href="#示例" class="headerlink" title="示例"></a>示例</h2><p>绕z轴旋转角度$$\theta$$的旋转矩阵为：</p><p>$$R_z(\theta)&#x3D;\begin{bmatrix}<br>cos\theta      &amp; -sin\theta &amp; 0      \<br>sin\theta &amp; cos\theta  &amp; 0 \<br>0      &amp; 0 &amp; 1<br>\end{bmatrix}$$</p><h2 id="优点"><a href="#优点" class="headerlink" title="优点"></a>优点</h2><ol><li><p>直观，与线性代数密切相关</p></li><li><p>可直接用于矩阵乘法和组合变换</p></li><li><p>不会受到万向锁影响</p></li></ol><blockquote><p>旋转矩阵本质上是一个三维SO(3)群上的元素，能够完整、连续、唯一地表示三维旋转（不考虑数值误差时）</p></blockquote><h2 id="缺点"><a href="#缺点" class="headerlink" title="缺点"></a>缺点</h2><ol><li><p>占内存：有9个浮点数</p></li><li><p>数值不稳定：连续运算后正交性容易丢失</p></li><li><p>不易插值</p></li></ol><blockquote><p>在动画、路径规划、机器人控制、视觉 SLAM 等场景中，我们常常需要在两个姿态（旋转）之间进行<strong>平滑过渡</strong>，这就需要插值（interpolation）。旋转矩阵是 3×3 的正交矩阵，插值并不能直接通过对矩阵元素线性插值来实现。</p><p>比如：$$R_{interp}&#x3D;(1-\alpha)R_1+\alpha R_2$$，但这个结果可能不再是正交矩阵，从而不再是合法的旋转矩阵<br><strong>tips:&#x20;</strong>&#x4F7F;用SVD强制将插值结果正交化；将旋转矩阵转换为四元数–&gt;使用SLERP插值–&gt;再转换回旋转矩阵</p></blockquote><ul><li>用欧拉角构造旋转矩阵或从旋转矩阵提取欧拉角时，有时会受到万向锁影响</li></ul><h1 id="四元数（Quaternion）"><a href="#四元数（Quaternion）" class="headerlink" title="四元数（Quaternion）"></a>四元数（Quaternion）</h1><h2 id="定义-1"><a href="#定义-1" class="headerlink" title="定义"></a>定义</h2><p>是一种扩展复数系统的表示方式，用来表示三维空间的旋转</p><p>表示为：</p><p>$$q&#x3D;w+xi+yj+zk&#x3D;[w,\vec{v}]<br>$$ 或 $$q&#x3D;[w,x,y,z]$$</p><p>其中，$$w$$是实部；$$x,y,z$$是虚部；$$||q||&#x3D;1$$为单位四元数，表示一个旋转；$$\vec{v}&#x3D;(x,y,z)$$</p><p>可以表示绕单位向量$$\vec{n}$$旋转角$$\theta$$的旋转：</p><p>$$q&#x3D;cos(\frac{\theta}{2})+\vec{n}sin(\frac{\theta}{2})$$</p><h2 id="作用-1"><a href="#作用-1" class="headerlink" title="作用"></a>作用</h2><p>旋转一个向量$$\vec{v}$$（扩展为纯四元数$$v_q&#x3D;[0,v_x,v_y,v_z]$$）的方法是：</p><p>$$v’&#x3D;qv_qq^{-1}$$</p><h2 id="优点-1"><a href="#优点-1" class="headerlink" title="优点"></a>优点</h2><ol><li><p>稠密紧凑：只用4个数</p></li><li><p>插值平滑（球面线性插值SLERP）</p></li></ol><blockquote><p>Lerp（线性插值）</p><p>在两个向量之间直接做线性插值：$$lerp(A,B,t)&#x3D;(1-t)A+tB$$</p><p>但这在单位球面上会走一条弦线（不是最短圆弧），且插值后的结果一般不在球面上，需归一化。</p><p>SLERP（球面插值）</p><p>SLERP 在单位球面上两点之间走最短圆弧路径：$$slerp(q_1,q_2,t)&#x3D;\frac{sin((1−t)\theta)}{sin\theta}q_1+\frac{sin(t\theta)}{sin\theta}q_2$$，$$\theta&#x3D;cos^{-1}(q_1\cdot q_2)$$</p><p>优点：恒定角速度；路径最短；始终在单位球面上；连续插值</p><p>Attention：如果四元数$$q_1\cdot q_2 &lt; 0$$，点积为负，会选择“长路插值”，因此插值前需监测点积符号，若小于0，就用$$-q_2$$代替$$q_2$$，保持“最短弧”方向</p></blockquote><ul><li><p>不会出现万向锁</p></li><li><p>数值稳定性高</p></li></ul><h2 id="缺点-1"><a href="#缺点-1" class="headerlink" title="缺点"></a>缺点</h2><ol><li><p>不够直观</p></li><li><p>存在双重表示：$$q$$和$$-q$$表示同一旋转</p></li></ol><blockquote><p>$$−q\cdot \vec{v} \cdot (-q)^{-1}&#x3D;q\cdot \vec{v} \cdot q^{-1}<br>$$</p></blockquote><ul><li>不易人工构造</li></ul><h1 id="欧拉角（Euler-Angles）"><a href="#欧拉角（Euler-Angles）" class="headerlink" title="欧拉角（Euler Angles）"></a>欧拉角（Euler Angles）</h1><h2 id="定义-2"><a href="#定义-2" class="headerlink" title="定义"></a>定义</h2><p>用三个有序角度（yaw,pitch,roll）来描述物体在3D空间中的姿态</p><p>常见轴顺序：<strong>ZYX&#x20;</strong></p><h2 id="作用-2"><a href="#作用-2" class="headerlink" title="作用"></a>作用</h2><p>比如一个角度序列$$(\phi,\theta,\psi)$$，表示依次绕固定轴旋转：</p><p>$$R&#x3D;R_z(\psi)R_y(\theta)R_x(\phi)$$</p><h2 id="优点-2"><a href="#优点-2" class="headerlink" title="优点"></a>优点</h2><ol><li><p>易于理解（偏航、俯仰、翻滚）</p></li><li><p>参数少</p></li></ol><h2 id="缺点-2"><a href="#缺点-2" class="headerlink" title="缺点"></a>缺点</h2><ol><li><p>容易引发<strong>万向锁（Gimbal Lock）</strong>：两个旋转轴对齐，导致自由度丢失</p></li><li><p>角度不唯一，周期性引起歧义</p></li><li><p>不适合插值</p></li></ol>]]></content>
    
    
    
  </entry>
  
  
  
  
</search>
